%! Author = Jander Moreira
%! Email =  moreira.jander@gmail.com

\documentclass[a4paper, 11pt]{article}
\usepackage[T1]{fontenc}

% \usepackage{amsfonts}
% \usepackage{amsmath}
\usepackage{textcomp}
\usepackage[all]{nowidow}
\usepackage{etoolbox}
\usepackage{multicol}

% \usepackage{array}

\usepackage{enumitem}
\setlist{nosep}

\usepackage[all, all-palettes]{palettize}


%% Layout

% geometry
\usepackage{geometry}
\geometry{top = 2.5cm, bottom = 2cm, right = 2.5cm, left = 4cm}

% hyperref
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    urlcolor = blue!20!black,
    linkcolor = blue!10!black,
    citecolor = black!80,
}

% cleveref
\usepackage{cleveref}

% makeidx
\usepackage{makeidx}
\makeindex

% minted
\usepackage[outputdir = ./out]{minted}
% \usemintedstyle{borland}
\newminted{latex}{autogobble, breaklines, bgcolor = blue!5, fontsize = \footnotesize}
\newmintinline{latex}{}

% tcolorbox
\usepackage{tcolorbox}
\usepackage{color}
\usepackage{comment}
\tcbuselibrary{skins, listings, minted, breakable}
\tcbset{
    colback = blue!3,
    sharp corners,
    box align = top,
    boxrule = 0pt,
    fontupper = \footnotesize,
    fontlower = \footnotesize,
    minted options={
        fontsize = \footnotesize,
        breaklines,
        autogobble,
    },
    listing engine = minted,
}

% Versions
\usepackage{versionchanges}
\usepackage{biblatex}

%% Text support

% macro arguments formats
\colorlet{argumentcolor}{orange!50!black}
\NewDocumentCommand{\Argument}{ m }{%
    \textcolor{argumentcolor}{$\langle$\normalfont\small\textsl{#1}$\rangle$}%
}
\NewDocumentCommand{\MArg}{ m }{\mbox{\texttt{\{}\Argument{#1}\texttt{\}}}}
\NewDocumentCommand{\OArg}{ m }{\mbox{\texttt{[}\Argument{#1}\texttt{]}}}
\NewDocumentCommand{\LArg}{ m }{\mbox{\texttt{<}\Argument{#1}\texttt{>}}}
\NewDocumentCommand{\PackageName}{ m }{\mbox{\textsf{#1}}}
\NewDocumentCommand{\Deprecated}{}{\textcolor{red!80!black}{(deprecated)}}
\NewDocumentCommand{\FromPackage}{ m }{%
    \tikz\node[draw, rounded corners = 1.5pt, inner sep = 1.5pt,
        font = \sffamily\tiny] {#1};%
}
\NewDocumentCommand{\Empty}{}{%
    \mbox{\normalfont\textcolor{black!60}{\textsl{--empty--}}}
}
\NewDocumentCommand{\Option}{ m }{%
    \mbox{\textcolor{green!40!black}{\texttt{#1}}}%
}
\NewDocumentCommand{\OptionInd}{ m }{%
    \index{#1@\texttt{#1}}%
    \Option{#1}%
}
\NewDocumentCommand{\OptionRef}{ m }{%
    \hyperref[option:#1]{\Option{#1}}%
}
\NewDocumentCommand{\Macro}{ m }{%
    \expandafter\latexinline\expandafter{\csname#1\endcsname}%
}
\NewDocumentCommand{\MacroRef}{ m }{%
    \hyperref[macro:#1]{\Macro{#1}}%
}
\NewDocumentCommand{\MacroDef}{ m }{%
    \index{#1@\texttt{\textbackslash #1}}%
    \refstepcounter{MacroCounter}%
    \label{macro:#1}%
    \Macro{#1}%
}
\NewDocumentCommand{\MacroRefInd}{ m }{%
    \index{#1@\texttt{\textbackslash #1}}%
    \MacroRef{#1}%
}

\tcbset{
    description/.style = {
        coltitle = black,
        fontupper = \normalsize,
        colbacktitle = white,
        titlerule = 0.001pt,
        enhanced jigsaw,
        breakable,
        width = \dimexpr \linewidth - 2em \relax,
        flush right,
        top = 0.5ex,
        bottom = 0pt,
        left = 0pt,
        right = 0pt,
        opacitybacktitle = 0,
        opacityframe = 0,
        opacityback = 0,
    }
}

\NewDocumentEnvironment{macro}{ m O{} o }{%
    %! formatter = off
    \index{#1@\texttt{\textbackslash#1}}%
    \refstepcounter{MacroCounter}%
    \label{macro:#1}%
%! parser = off
    \IfValueTF{#3}{%
        \begin{macro*}{#1}{#2}
    }{%
        \begin{macro*}{#1}{#2}[#3]%
    }
    %! parser = on
        }{%
%! parser = off
    \end{macro*}
    %! parser = on
    %! formatter = on
}
\newcounter{MacroCounter}
\NewDocumentEnvironment{macro*}{ m m o }{
    \medskip\par%
    \begin{tcolorbox}[
        title = {\hspace{-2em}\Macro{#1}#2\IfValueT{#3}{\latexinline!{#3} !}},
        description,
    ]
    }{
    \end{tcolorbox}%
    \medskip%
}

\newlength{\docassignment}
\NewDocumentEnvironment{option}{ m m o }{%
    \label{option:#1}%
    \settowidth{\docassignment}{#2}%
    \begin{tcolorbox}
        [
        title = {%
            \hspace{-2em}\OptionInd{#1}%
            \ifdim
                \docassignment>0pt\Option{ = #2}
            \fi%
            \IfValueT{#3}{\hfill\textit{Default:} \Option{#3}}
        },
        description,
        ]
            }{
    \end{tcolorbox}%
    \medskip%
}
\NewDocumentEnvironment{option*}{ m }{%
    \begin{tcolorbox}[title = {\hspace{-2em}#1}, description]
    }{
    \end{tcolorbox}%
    \medskip%
}
\NewDocumentEnvironment{optionnoind}{ m m }{%
    \begin{tcolorbox}[
        title = {\hspace{-2em}\Option{#1 = #2}},
        description,
    ]
    }{
    \end{tcolorbox}%
    \medskip%
}

%% Repetitive text
\NewDocumentCommand{\MacroOptionsText}{}{%
    Any \Argument{options} specified uniquely affect this macro.%
}
\NewDocumentCommand{\BlockOptionsText}{}{%
    Any of the \Argument{options} specified in this macro will affect this command and all items in the inner block, propagating up to and including the closing macro.%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{%
    The \PackageName{palettize} package \textcolor{red}{ -- Pre-release}\thanks{This document corresponds to \PackageName{palettize}~v\PLTVersion, dated \PLTDate. This text was last revised \today.}%
}
\author{Jander Moreira -- \texttt{moreira.jander@gmail.com}}
\date{July 25, 2024}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
\maketitle
\sloppy

\begin{abstract}
    The \PackageName{palettize} package add color pallets to documents.
\end{abstract}

\tableofcontents

\VCRegisterVersion{0.1}{2024-07-24}

\VCPrintChanges


\section{Introduction}

This package was first released as v0.1%
\VCChange[disable]{
    type = released,
    version = 0.1,
    description = Initial version,
}.


\section{Package usage and options}\label{sec:package-usage-and-options}
This package is a collection of modules that can be loaded as options passed to the package \PackageName{palettize} or as standalone packages. It depends on the following packages:

\begin{center}
    \begin{tabular}{ll}
        \PackageName{etoolbox}  & (\url{https://ctan.org/pkg/etoolbox})  \\
        \PackageName{tcolorbox} & (\url{https://ctan.org/pkg/tcolorbox}) \\
        \PackageName{xcolor}    & (\url{https://ctan.org/pkg/xcolor})    \\
    \end{tabular}
\end{center}

\begin{macro*}{usepackage}{\OArg{options list}}[palettize]
    The basic usage is as follows.

    \begin{latexcode}
        \usepackage{palettize}
    \end{latexcode}

    This will load several macros to handle color palettes, as described in \cref{sec:palettes}.

    \bigskip
    Package \PackageName{palettize}'s specific options are:

    \begin{option}{all-palettes}{}
        With \Option{all-palettes}, all pre-defined palettes are loaded and made available for use. The shipped palettes are presented in \Cref{sec:available-palettes}.
    \end{option}

    \bigskip
    To load modules, the following options can be passed:

    \begin{option}{boxes}{}
        The module \Option{boxes} provides an easy way to transform a list of \Macro{items} in a colorful matrix of boxes.

        This module can also be loaded with:
        \begin{latexcode}
            \usepackage{palettize-boxes}
        \end{latexcode}

        Details in \Cref{sec:boxes}.
    \end{option}

    \begin{option}{itemizer}{}
        This option enhances environments such as \latexinline{enumerate}, \latexinline{itemize}, and \latexinline{description} to use color palettes.

        This module can also be loaded with:
        \begin{latexcode}
            \usepackage{palettize-itemizer}
        \end{latexcode}

        Details in \Cref{sec:itemizer}.
    \end{option}

    \begin{option}{getitems}{}
        This option provides direct support to processing lists of items using the macro \latexinline{\item} as the itemizer. In practice, it provides macros for manipulating lists for other `palettize` resources, but can be used independently. \PackageName{palettize-getitems} is a ``core'' module used by \PackageName{palettize-boxes} and \PackageName{palettize-itemizer} and is available as a bonus feature.

        This module can also be loaded with:
        \begin{latexcode}
            \usepackage{palettize-getitems}
        \end{latexcode}

        Details in \Cref{sec:getitems}.
    \end{option}

    Each module may have its own set of options, which are describe in their respective sections. All the module-specific options can also be passed directely to \PackageName{palettize} and if its respective module is not loaded, they are simply ignored.
\end{macro*}


\section{The palettes of \PackageName{palettize}}\label{sec:palettes}

The package \PackageName{palettize} sees palettes as lists of background colors. Each color can be be a single background color as those defined using \PackageName{xcolor} or a foreground/background pair. A color pair is written \Argument{fg~color}~\latexinline{on}~\Argument{bg~color}, such as \latexinline{white on blue}. When just a single color is used in a palette, then the foreground color is the current document's color. For example, \latexinline{green} means \latexinline{. on green}\footnote{The ``dot'' color (\latexinline{.}) is the current color in package \PackageName{xcolor}.}.

A palette is created with \MacroRef{PLTCreatePalette}. As several different patterns can be created, the concept of current palette is used. To change the current palette, \MacroRef{PLTUsePalette} must be used. There is a default palette (see~\Cref{sec:available-palettes})

Most of the macros will use the current palette, unless otherwise stated.

\begin{macro}{PLTCreatePalette}[\MArg{palette~name}]
    \Macro{PLTCreatePalette} creates a new, empty palette called \Argument{palette~name} and inserts its name in list of defined palettes. Trying to create a palette with an existing name results in error.
\end{macro}

\begin{macro}{PLTSetPalette}[\OArg{palette~name}\MArg{list~of~colors}]
    The \Argument{list~of~colors} is comma-separated list of colors (single or in pairs) to be assigned to \Argument{pallete~name}.
\end{macro}

\begin{tcblisting}{listing only}
    \PLTCreatePalette{sample}
    \PLTSetPalette{sample}{
        white on blue,
        white on red!50!black,
        blue on orange!60,
        green  % single color
    }
\end{tcblisting}

The current palette can be set with \MacroRef{PLTUsePalette}.

\begin{macro}{PLTUsePalette}[\MArg{palette~name}]
    This macro makes \Argument{palette~name} the current palette, so defining which palette macros such as \MacroRef{PLTUseCurrentColor} and \MacroRef{PLTNextColor}, for example, will work with.
\end{macro}

A palette set with \MacroRef{PLTSetPalette} is an ordered list of color and after set, its first color is the current color of the palette. The \PackageName{xcolor}'s colors \latexinline{PLTBGColor} and \latexinline{PLTFGColor} hold the current color.

\begin{tcblisting}{}
    \PLTCreatePalette{my colors}
    \PLTSetPalette{my colors}{
        yellow on blue,
        white on black,
        black!40
    }
    \PLTUsePalette{my colors}

    The first color is \colorbox{PLTBGColor}{\textcolor{PLTFGColor}{this one}} and the second is \PLTNextColor\colorbox{PLTBGColor}{\textcolor{PLTFGColor}{this}}.

    \PLTNextColor
    And \colorbox{PLTBGColor}{\textcolor{PLTFGColor}{this}} is the last one.
\end{tcblisting}


To change the current color, \MacroRef{PLTNextColor} will step to the next color, and \MacroRef{PLTResetLoop} will set the current color back to the first one.

\begin{macro}{PLTNextColor}[\OArg{palette~name}]
    \Macro{PLTNextColor} changes the current color to the next in the sequence in an endless loop.

    If an optional \Argument{palette~name} is specified, then the current color of that pattern is modified. This will not change the current palette.
\end{macro}

\begin{macro}{PLTResetLoop}[\OArg{palette~name}]
    Set the first color of the palette as the current color.

    If an optional \Argument{palette~name} is specified, then the current color of that pattern is modified. This will not change the current palette.
\end{macro}

\begin{tcblisting}{}
    % \usepackage{etoolbox}
    \PLTCreatePalette{primary}
    \PLTSetPalette{primary}{red, blue, yellow}
    \PLTCreatePalette{secondary}
    \PLTSetPalette{secondary}{green, orange, violet}

    \PLTUsePalette{primary}  % sets current palette

    \forcsvlist{
        \PLTUseCurrentColor
        \fcolorbox{black}{PLTBGColor}{\hspace{3em}} \qquad
        \PLTUseCurrentColor[secondary]
        \fcolorbox{black}{PLTBGColor}{\hspace{3em}}
        \PLTNextColor
        \PLTNextColor[secondary]
    }{\par, \par, \par, \par, \par, \par, \par} % 7 times
\end{tcblisting}


As already described, the current color always sets \latexinline{PLTBGColor} and \latexinline{PLTFGColor}. Their names are available through \MacroRef{PLTBGColorName} and \MacroRef{PLTFGColorName} respectively.

\begin{macro}{PTLBGColorName}[\OArg{pattern~name}]
    \Macro{PTLBGColorName} expands to the current background color name of the current pattern.

    If an optional \Argument{palette~name} is specified, then the current color of that pattern is the result. This will not change the current palette.
\end{macro}

\begin{macro}{PTLFGColorName}[\OArg{pattern~name}]
    \Macro{PTLFGColorName} expands to the current foreground color name of the current pattern.

    If an optional \Argument{palette~name} is specified, then the current color of that pattern is the result. This will not change the current palette.
\end{macro}

\begin{tcblisting}{}
    % \usepackage{etoolbox}
    \definecolor{indigo}{RGB}{75, 0, 130}
    \PLTCreatePalette{rainbow}
    \PLTSetPalette{rainbow}{red, orange, yellow, green, blue, indigo, violet}
    \PLTUsePalette{rainbow}

    \begin{center}
        \forcsvlist{%
            \textcolor{PLTBGColor}{\textbf{\PLTBGColorName}}, %
            \PLTNextColor%
        }{{}, {}, {}, {}, {}, {}}%
        and \textcolor{PLTBGColor}{\textbf{\PLTBGColorName}}.

        \medskip
        \PLTResetLoop
        \forcsvlist{%
            \textcolor{PLTBGColor}{\rule{1.15cm}{1em}}%
            \PLTNextColor%
        }{{}, {}, {}, {}, {}, {}, {}}%
    \end{center}
\end{tcblisting}

\subsection{Available palettes}\label{sec:available-palettes}

Some palettes are shipped with this package and can be loaded with \MacroRef{PLTUseResource}.

\begin{macro}{PLTUseResource}[\MArg{list~of~resources}]
    The \Argument{list~of~resources} is a comma-separated list of resources that can be loaded. This macro can allows to use pre-existing palettes, which are stored in files named \texttt{palettize-\Argument{resource~name}.tex}.
\end{macro}

\begin{latexcode}
    \PLTUseResource{sliced-citrus, toasted-peach}
\end{latexcode}

\subsubsection*{The default palette}

A palette called \latexinline{nightfall-ambiance} is always loaded and it is used as the default palette by all modules.

\begin{tcolorbox}[width = 0.5\linewidth]
    \textbf{Palette nightfall-ambiance}\medskip\par
    \PLTLoopPalette{nightfall-ambiance}{%
        \tikz \node[draw, fill = PLTBGColor, text = PLTFGColor, font = \bfseries\sffamily, text width = 0.95\linewidth, text height = 1em] {\PLTFGColorName\ on \PLTBGColorName };
    }\par
\end{tcolorbox}%


\subsubsection*{List of palettes}

The following palettes are available.

\begin{multicols}{2}
    \PLTLoopPaletteList{
        \expandafter\ifstrequal\expandafter{\PLTCurrentPalette}{nightfall-ambiance}{}{%
            \par
            \begin{tcolorbox}
                \textbf{Palette \PLTCurrentPalette}\medskip\par
                \latexinline{\PLTUseResource}\texttt{\{\PLTCurrentPalette\}}\strut\bigskip\par
                \PLTLoopPalette{\PLTCurrentPalette}{%
                    \PLTUsePalette{\PLTCurrentPalette}
                    \tikz \node[draw, fill = PLTBGColor, text = PLTFGColor,
                        font = \bfseries\sffamily, text width = 0.95\linewidth, text height = 1em] {\PLTFGColorName\ on \PLTBGColorName\strut};%
                    \par%
                }
            \end{tcolorbox}%
        }%
    }
\end{multicols}

The palette \latexinline{default} can also be used, but is not loadable.

\subsection{Palettes are local!}

If a palette is used or created in a local scope\todo{Escrever!}

\subsection{Looping through palettes and colors}

A simple mechanism is provided to access the list of palettes and the colors inside each one.

\begin{macro}{PLTLoopPaletteList}[\MArg{code}]
    This macro executes \Argument{code} for each existing palette. In each iteration \MacroDef{PLTCurrentPalette} is set to the palette's name, but the palette is not set as default with \MacroRef{PLTUsePalette}.
\end{macro}

\begin{tcblisting}{}
    Palletes:

    \begin{enumerateenumerate}
        \PLTLoopPaletteList{\item \PLTCurrentPalette}
    \end{enumerateenumerate}
\end{tcblisting}

\begin{macro}{PLTLoopPalette}[\MArg{palette name}\MArg{code}]
    This provides an iteration through all colors in \Argument{palette name} executing \Argument{code}. The colors \latexinline{PLTBGColor} and \latexinline{PLTFGColor} are set properly in each interaction. \MacroRef{PLTBGColorName} and \Macro{PLTFGColorName} are also available.
\end{macro}

\begin{tcblisting}{}
    % \usepackage{tikz}
    \PLTCreatePalette{new example}
    \PLTSetPalette{new example}{
        red!50!black on orange!50,
        green!50!black on green!40!black!50,
        blue!60 on blue!50!black
    }
    \PLTLoopPalette{new example}{%
        \tikz\path[draw = PLTFGColor, fill = PLTBGColor, ultra thick] (0, 0) circle (5pt);\quad%
    }
\end{tcblisting}

\section{Modules}

This sections describes the modules in detail.

\subsection{Boxes}\label{sec:boxes}

\begin{tcblisting}{}
    \begin{PLTBoxItemize}
        <raster columns = 2>
        \item[Software] Computer programs that instruct the execution of a computer.
        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
        \item[Firmware] Software that provides low-level control of computing device hardware.
        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{PLTBoxItemize}
\end{tcblisting}

\begin{tcblisting}{}
    \PLTCreatePalette{shades of blue}
    \PLTSetPalette{shades of blue}{
        black on blue!40,
        black on blue!50,
        black!10 on blue!90!black,
        black!5 on blue!80!black
    }
    \PLTUsePalette{shades of blue}
    \begin{PLTBoxItemize}
        \item[Software] Computer programs that instruct the execution of a computer.
        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
        \item[Firmware] Software that provides low-level control of computing device hardware.
        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{PLTBoxItemize}
\end{tcblisting}

\begin{tcblisting}{}
    \PLTCreatePalette{shades of green}
    \PLTSetPalette{shades of green}{
        white on green!80!brown!55!black,
        white on green!30!black
    }
    \PLTUsePalette{shades of green}
    \begin{PLTBoxItemize}
        <raster columns = 1, raster equal height = none>
        \item[Software] Computer programs that instruct the execution of a computer.
        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
        \item[Firmware] Software that provides low-level control of computing device hardware.
        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{PLTBoxItemize}
\end{tcblisting}

\begin{tcblisting}{}
    \PLTUseResource{toasted-peach}
    \PLTUsePalette{toasted-peach}
    \begin{tcolorbox}[colback = black]
        \begin{PLTBoxEnumerate}
            <raster columns = 2>
            \item[Software] Computer programs that instruct the execution of a computer.
            \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
            \item[Firmware] Software that provides low-level control of computing device hardware.
            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
        \end{PLTBoxEnumerate}
    \end{tcolorbox}
\end{tcblisting}

\subsection{Lists}\label{sec:itemizer}

The module \PackageName{palettize-itemizer} adds color palettes to lists. Currently, the environments \latexinline{enumerate}, \latexinline{itemize}, and \latexinline{description} are affected. The default palette is applied to these environments (see \Cref{sec:available-palettes}).

\begin{macro*}{usepackage}{\OArg{options list}}[palettize-itemizer]
    Package options include the following:

    \begin{option}{keep-enumerate}{}
        When specified, \Option{keep-enumerate} preserves the original \latexinline{enumerate} environment untouched.
    \end{option}

    \begin{option}{keep-itemize}{}
        When specified, \Option{keep-itemize} preserves the original \latexinline{itemize} environment untouched.
    \end{option}

    \begin{option}{keep-description}{}
        When specified, \Option{keep-description} preserves the original \latexinline{description} environment untouched.
    \end{option}

    \begin{option}{keep-all}{}
        This is the same as using \Option{keep-enumerate}, \Option{keep-itemize}, and \Option{keep-description} toghether.
    \end{option}

    All of these options can be specified also when using \latexinline{\usepackage{palettize}}. For example:

    \begin{latexcode}
        \usepackage[itemizer, keep-description]{palettize}
    \end{latexcode}
\end{macro*}

The modified lists are exemplified below.

\begin{tcblisting}{}
    \begin{itemize}
        \item Software: Computer programs that instruct the execution of a computer.
        \item Hardware: The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
        \item Firmware: Software that provides low-level control of computing device hardware.
        \item Middleware: Type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{itemize}
\end{tcblisting}

\begin{tcblisting}{}
    \begin{enumerate}
        \item Software: Computer programs that instruct the execution of a computer.
        \item Hardware: The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
        \item Firmware: Software that provides low-level control of computing device hardware.
        \item Middleware: Type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{enumerate}
\end{tcblisting}

\begin{tcblisting}{}
    \begin{tabular}{p{0.45\linewidth}p{0.45\linewidth}}
        \begin{description}
            \item[Software] Computer programs that instruct the execution of a computer.
            \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
            \item[Firmware] Software that provides low-level control of computing device hardware.
            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
        \end{description}
        &
        \PLTUseResource{sliced-citrus}
        \PLTUsePalette{sliced-citrus}
        \begin{description}
            \item[Software] Computer programs that instruct the execution of a computer.
            \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
            \item[Firmware] Software that provides low-level control of computing device hardware.
            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
        \end{description}
    \end{tabular}
\end{tcblisting}

\subsubsection{New environments for lists}

Three new environments were created to handle palette-aware lists: \latexinline{PLTEnumerate}, \latexinline{PLTItemize}, and \latexinline{PLTDescription}. These are used to replace their respective counterparts. Yet, they can be used directly.

\begin{center}
    \begin{tabular}{ll}
        \textbf{Environment}      & \textbf{Replacement environment} \\
        \hline
        \latexinline{enumerate}   & \latexinline{PLTEnumerate}       \\
        \latexinline{itemize}     & \latexinline{PLTItemize}         \\
        \latexinline{description} & \latexinline{PLTDescription}     \\
        \hline
    \end{tabular}
\end{center}

When the option \OptionRef{keep-all} is used, all colored environments are available using these alternatives.

\begin{tcblisting}{}
    \begin{PLTEnumerate}
        \item One
        \item Two
        \item Three
    \end{PLTEnumerate}

    \medskip
    \begin{PLTItemize}
        \item One
        \item Two
        \item Three
    \end{PLTItemize}

    \medskip
    \begin{PLTDescription}
        \item [One] First.
        \item [Two] Second.
        \item [Three] Third.
    \end{PLTDescription}
\end{tcblisting}

\subsubsection{Accessing the original list environments}

If a list environment was not preserved by any of the \Option{keep-\Argument{list name}} options it can still be used with the renamed environments below.

\begin{center}
    \begin{tabular}{ll}
        \textbf{Environment}      & \textbf{Renamed environment}         \\
        \hline
        \latexinline{enumerate}   & \latexinline{enumerateenumerate}     \\
        \latexinline{itemize}     & \latexinline{itemizeitemize}         \\
        \latexinline{description} & \latexinline{descriptiondescription} \\
        \hline
    \end{tabular}
\end{center}

\bigskip
\begin{tcblisting}{}
    This is an original unnumbered list:

    \begin{itemizeitemize}
        \item Software: Computer programs that instruct the execution of a computer.
        \item Hardware: The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
        \item Firmware: Software that provides low-level control of computing device hardware.
        \item Middleware: Type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{itemizeitemize}
\end{tcblisting}

\subsection{Compatibility with other packages}

The module \PackageName{palettize-itemizer} seem to be compatible with \PackageName{enumitem}\footnote{\url{https://www.ctan.org/pkg/enumitem}} and \PackageName{enumerate}\footnote{\url{https://www.ctan.org/pkg/enumerate}}, but no extensive testes were carried out.


\section{Known issues and limitations}\label{sec:known-issues-and-limitations}

\begin{center}
    \begin{descriptiondescription}
        \item[\PackageName{pgffor}] current color is local and \latexinline{\foreach} will not work.
        \item[] Foreground color changes inside boxes using \Macro{color} or \Macro{textcolor} are bounded by the limitations described in the documentation of \PackageName{xcolor} (Section~2.6.4, \PackageName{xcolor} v2.14, 2022/06/12).
    \end{descriptiondescription}
\end{center}

\clearpage
\appendix


\section{Processing itemized lists}\label{sec:getitems}
These are tools for processing lists with \Macro{item} as itemizer.

\begin{macro}{PLTGatherItems}[\MArg{text}]
    The \Argument{text} is parsed looking for \Macro{item} macros and each item is stored in an internal list. Anything before the first \Macro{item} is also stored as the header of the list. The header can be retrieved with \MacroRef{PLTGetHeader} and items individually retrieved with \MacroRef{PLTGetItem}. The items list can also be sequentially processed using \MacroRef{PLTMapCommand}.

    Leading and following spaces are trimmed.
\end{macro}

\begin{macro}{PLTGetHeader}
    This macro expands to the header of the last list parsed with \MacroRef{PLTGatherItems}.
\end{macro}

\begin{macro}{PLTGetItem}[\MArg{item~number}]
    This macro expands to the \Argument{item~number}\textsuperscript{th} item the last list parsed with \MacroRef{PLTGatherItems}.
\end{macro}

\begin{tcblisting}{}
    \PLTGatherItems{
        Grocery list
        \item Beans
        \item Broccoli
        \item Cabbage
        \item Cauliflower
        \item Ginger
        \item Ladyfinger
    }

    This is my \PLTGetHeader: \PLTGetItem{1} and \PLTGetItem{4} are present.
\end{tcblisting}

\begin{macro}{PLTMapCommand}[\MArg{macro}]
    \Macro{PLTMapCommand} sequentially runs \Argument{macro} in every item.
\end{macro}

\begin{tcblisting}{}
    \PLTGatherItems{
        \item artificial intelligence,
        \item cloud computing, and
        \item security.
    }
    \NewDocumentCommand{\showwithbullet}{ +m }{\textbullet~#1 }
    Important topics: \PLTMapCommand{\showwithbullet}
\end{tcblisting}

%! formatter = off
\begin{tcblisting}{}
    \NewDocumentCommand{\showinline}{ +m }{>>~#1 }
    \NewDocumentEnvironment{importantlisting}{ +b }{%
        \PLTGatherItems{#1}
        \textbf{\PLTGetHeader}
        \PLTMapCommand{\showinline}
        }{}

    \begin{importantlisting}
        Very important things:\par
        \item Eat%
        \begin{importantlisting}
            How?
            \item Healthy
            \item Many vegetables
            \item No TV
            \item No smartphone
        \end{importantlisting}
        \par
        \item Pray\par
        \item Love\par
    \end{importantlisting}
\end{tcblisting}
%! formatter = on

\begin{macro}{PLTParseItem}[\MArg{type~macro}\MArg{angle~macro}\MArg{brackets-macro}\MArg{text~macro}\MArg{text}]
    This macro parses \Argument{text} looking for leading options using both angle or square brackets. The results are:
    \begin{itemizeitemize}
        \item \Argument{type~macro} is set to
        \begin{itemizeitemize}
            \item \latexinline{A} if only angle brackets are present;
            \item \latexinline{B} if only (square) brackets are present;
            \item \latexinline{AB} if both angle and square brackets are present, in any order;
            \item \latexinline{N} otherwise;
        \end{itemizeitemize}
        \item \Argument{angle~macro} is set to the content between angle brackets;
        \item \Argument{brackets~macro} is set to the content between brackets;
        \item \Argument{text~macro} is set to the remaining content.
    \end{itemizeitemize}
\end{macro}

\begin{tcblisting}{}
    \PLTParseItem{\opttype}{\angleopts}{\bracketopts}{\body}{%
        [font=sffamily]<*>Some \textit{text}%
    }
    \noindent Code: \texttt{\opttype}\par
    In angle brackets: \texttt{\angleopts}\par
    In brackets: \texttt{\bracketopts}\par
    Text: \texttt{\body}\par
\end{tcblisting}

%! formatter = off
\begin{tcblisting}{}
    \NewDocumentCommand{\showiteminbox}{ +m }{%
        \PLTParseItem{\opttype}{\angleopts}{\bracketopts}{\body}{#1}%
        \fbox{%
            \strut%
            \PLTIfType{\opttype}{A, AB}{% if <> present, change font
                \angleopts%  new font
            }{%
                \sffamily%  default font for list
            }%
            \PLTIfType{\opttype}{B, AB}{% if [] present, change color
                \color{\bracketopts}%  new color
            }{%
                \color{gray}%  default color
            }%
            \body%
        }%
    }
    \NewDocumentEnvironment{boxedlist}{ +b }{%
        \PLTGatherItems{#1}%
        \PLTMapCommand{\showiteminbox}
        }{}

    \begingroup
    \color{brown}
    List:
    \begin{boxedlist}
        \item[orange]<\ttfamily> Orange  % changes color and font
        \item<\ttfamily>[orange] Orange again % changes color and font
        \item[blue] Blue  % changes only color
        \item<> Magenta?  % suppresses font (use current document's font)
        \item[green!50!black] Green  % changes only color
        \item[.] Brown  % uses current document's color
    \end{boxedlist}
    \endgroup
\end{tcblisting}
%! formatter = on


%% Index
\printindex

\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%