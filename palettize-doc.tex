%! Author = Jander Moreira
%! Email =  moreira.jander@gmail.com

\documentclass[a4paper, 11pt]{article}
\usepackage[T1]{fontenc}

\usepackage[all]{nowidow}
\usepackage{etoolbox}
\usepackage{multicol}
\usepackage{textcomp}

\usepackage{enumitem}
\setlist{nosep}

\usepackage[all, all-palettes, handwriting]{palettize}


%% Layout

% geometry
\usepackage{geometry}
\geometry{top = 2.5cm, bottom = 2cm, right = 2.5cm, left = 4cm}

% hyperref
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    urlcolor = blue!20!black,
    linkcolor = blue!10!black,
    citecolor = black!80,
}

% cleveref
\usepackage{cleveref}

% makeidx
\usepackage{makeidx}
\makeindex

% minted
\usepackage[outputdir = ./out]{minted}
% \usemintedstyle{borland}
\newminted{latex}{autogobble, breaklines, bgcolor = blue!5, fontsize = \footnotesize}
\newmintinline{latex}{}

% tcolorbox
\usepackage{tcolorbox}
\usepackage{color}
\usepackage{comment}
\tcbuselibrary{skins, listings, minted, breakable}

\newtcblisting{example}[1]{
    enhanced jigsaw,
    breakable,
    colback = blue!3,
    colframe = blue!40!black!30,
    sharp corners,
    box align = top,
    boxrule = 1pt,
    fontupper = \footnotesize,
    fontlower = \footnotesize,
    minted options = {
        fontsize = \footnotesize,
        breaklines,
        autogobble,
    },
    listing engine = minted,
%extras middle and last = {
%%    %\coordinate (A1) at ($(interior.south east) + (-10pt,5pt)$);
%%    %\coordinate (C1) at ($(interior.south east) + (-6pt,7.5pt)$);
%%    %\draw[fill=blue] (A1) -- +(0,5pt) -- (C1) -- cycle;
%    \draw[dashed, gray] (interior.south west) -- (interior.south east);
%},
    #1
}

% Versions
\usepackage{versionchanges}
\usepackage{biblatex}

%% Text support

% macro arguments formats
\colorlet{argumentcolor}{orange!50!black}
\NewDocumentCommand{\Argument}{ m }{%
    \textcolor{argumentcolor}{$\langle$\normalfont\small\textsl{#1}$\rangle$}%
}
\NewDocumentCommand{\MArg}{ m }{\mbox{\texttt{\{}\Argument{#1}\texttt{\}}}}
\NewDocumentCommand{\OArg}{ m }{\mbox{\texttt{[}\Argument{#1}\texttt{]}}}
\NewDocumentCommand{\LArg}{ m }{\mbox{\texttt{<}\Argument{#1}\texttt{>}}}
\NewDocumentCommand{\PackageName}{ m }{\mbox{\textsf{#1}}}
\NewDocumentCommand{\Deprecated}{}{\textcolor{red!80!black}{(deprecated)}}
\NewDocumentCommand{\FromPackage}{ m }{%
    \tikz\node[draw, rounded corners = 1.5pt, inner sep = 1.5pt,
        font = \sffamily\tiny] {#1};%
}
\NewDocumentCommand{\Empty}{}{%
    \mbox{\normalfont\textcolor{black!60}{\textsl{--empty--}}}
}
\NewDocumentCommand{\Option}{ m }{%
    \mbox{\textcolor{green!40!black}{\texttt{#1}}}%
}
\NewDocumentCommand{\OptionInd}{ m }{%
    \index{#1@\texttt{#1}}%
    \Option{#1}%
}
\NewDocumentCommand{\OptionRef}{ m }{%
    \hyperref[option:#1]{\Option{#1}}%
}
\NewDocumentCommand{\Macro}{ m }{%
    \expandafter\latexinline\expandafter{\csname#1\endcsname}%
}
\NewDocumentCommand{\MacroRef}{ m }{%
    \hyperref[macro:#1]{\Macro{#1}}%
}
\NewDocumentCommand{\MacroDef}{ m }{%
    \index{#1@\texttt{\textbackslash #1}}%
    \refstepcounter{MacroCounter}%
    \label{macro:#1}%
    \Macro{#1}%
}
\NewDocumentCommand{\MacroRefInd}{ m }{%
    \index{#1@\texttt{\textbackslash #1}}%
    \MacroRef{#1}%
}

\tcbset{
    description/.style = {
        coltitle = black,
        fontupper = \normalsize,
        colbacktitle = white,
        titlerule = 0.001pt,
        enhanced jigsaw,
        breakable,
        width = \dimexpr \linewidth - 2em \relax,
        flush right,
        top = 0.5ex,
        bottom = 0pt,
        left = 0pt,
        right = 0pt,
        opacitybacktitle = 0,
        opacityframe = 0,
        opacityback = 0,
    }
}

\NewDocumentEnvironment{macro}{ m O{} o }{%
    %! formatter = off
    \index{#1@\texttt{\textbackslash#1}}%
    \refstepcounter{MacroCounter}%
    \label{macro:#1}%
%! parser = off
    \IfValueTF{#3}{%
        \begin{macro*}{#1}{#2}
    }{%
        \begin{macro*}{#1}{#2}[#3]%
    }
    %! parser = on
        }{%
%! parser = off
    \end{macro*}
    %! parser = on
    %! formatter = on
}
\newcounter{MacroCounter}
\NewDocumentEnvironment{macro*}{ m m o }{
    \medskip\par%
    \begin{tcolorbox}[
        title = {\hspace{-2em}\Macro{#1}#2\IfValueT{#3}{\latexinline!{#3} !}},
        description,
    ]
    }{
    \end{tcolorbox}%
    \medskip%
}

\newlength{\docassignment}
\NewDocumentEnvironment{option}{ m m o }{%
    \label{option:#1}%
    \settowidth{\docassignment}{#2}%
    \begin{tcolorbox}
        [
        title = {%
            \hspace{-2em}\OptionInd{#1}%
            \ifdim
                \docassignment>0pt\Option{ = #2}
            \fi%
            \IfValueT{#3}{\hfill\textit{Default:} \Option{#3}}
        },
        description,
        ]
            }{
    \end{tcolorbox}%
    \medskip%
}
\NewDocumentEnvironment{option*}{ m }{%
    \begin{tcolorbox}[title = {\hspace{-2em}#1}, description]
    }{
    \end{tcolorbox}%
    \medskip%
}
\NewDocumentEnvironment{optionnoind}{ m m }{%
    \begin{tcolorbox}[
        title = {\hspace{-2em}\Option{#1 = #2}},
        description,
    ]
    }{
    \end{tcolorbox}%
    \medskip%
}

%% Repetitive text
\NewDocumentCommand{\MacroOptionsText}{}{%
    Any \Argument{options} specified uniquely affect this macro.%
}
\NewDocumentCommand{\BlockOptionsText}{}{%
    Any of the \Argument{options} specified in this macro will affect this command and all items in the inner block, propagating up to and including the closing macro.%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{%
    The \PackageName{palettize} package \textcolor{red}{ -- Pre-release}\thanks{This document corresponds to \PackageName{palettize}~v\PLTVersion, dated \PLTDate. This text was last revised \today.}%
}
\author{Jander Moreira -- \texttt{moreira.jander@gmail.com}}
\date{July 25, 2024}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
\maketitle
\sloppy

\begin{abstract}
    The \PackageName{palettize} package add color pallets to documents.
\end{abstract}

\tableofcontents

\VCRegisterVersion{0.1}{2024-07-24}

\VCPrintChanges


%\section{Introduction}
%
%This package was first released as v0.1%
%\VCChange[disable]{
%    type = released,
%    version = 0.1,
%    description = Initial version,
%}.
%

%\section{Package usage and options}\label{sec:package-usage-and-options}
%
%This package is a collection of modules that can be loaded as options passed to the \PackageName{palettize} package or as standalone packages.
%
%Currently, the implementation depends on the following packages:
%
%\begin{center}
%    \begin{tabular}{ll}
%        \PackageName{etoolbox}  & (\url{https://ctan.org/pkg/etoolbox})  \\
%        \PackageName{tcolorbox} & (\url{https://ctan.org/pkg/tcolorbox}) \\
%        \PackageName{xcolor}    & (\url{https://ctan.org/pkg/xcolor})    \\
%    \end{tabular}
%\end{center}
%
%\begin{macro*}{usepackage}{\OArg{options list}}[palettize]
%    The basic usage is as follows.
%
%    \begin{latexcode}
%        \usepackage{palettize}
%    \end{latexcode}
%
%    This will define several macros for manipulating color palettes, as described in \cref{sec:palettes}, and is the core of the package.
%
%    \bigskip
%    Package \PackageName{palettize}'s specific options are:
%
%    \begin{option}{all-palettes}{}
%        With \Option{all-palettes}, all predefined palettes are loaded and made available for use. The full list is given in \Cref{sec:available-palettes}.
%    \end{option}
%
%    \bigskip
%    To load specific modules, the following options can be passed:
%
%    \begin{option}{boxes}{}
%        The \Option{boxes} module provides an easy way to turn a list of \Macro{items} into a colored array of boxes.
%
%        This module can also be loaded with:
%        \begin{latexcode}
%            \usepackage{palettize-boxes}
%        \end{latexcode}
%
%        Details in \Cref{sec:boxes}.
%    \end{option}
%
%    \begin{option}{itemizer}{}
%        This option enhances environments like \latexinline{enumerate}, \latexinline{itemize} and \latexinline{description} to use color palettes.
%
%        This module can also be loaded with:
%        \begin{latexcode}
%            \usepackage{palettize-itemizer}
%        \end{latexcode}
%
%        Details in \Cref{sec:itemizer}.
%    \end{option}
%
%    \begin{option}{getitems}{}
%        This option provides direct support for processing lists of items using the \latexinline{\item} macro as an itemizer. In practice, it provides macros for manipulating lists for other \PackageName{palettize} modules, but can be used independently. \PackageName{palettize-getitems} is a ``core'' module used by \PackageName{palettize-boxes} and \PackageName{palettize-itemizer} and is available as a bonus feature.
%
%        This module can also be loaded with:
%        \begin{latexcode}
%            \usepackage{palettize-getitems}
%        \end{latexcode}
%
%        Details in \Cref{sec:getitems}.
%    \end{option}
%
%    Each module can have its own set of options, which are described in their respective sections. All module-specific options can also be passed directly to \PackageName{palettize} and if their respective module is not loaded, they are simply ignored.
%
%    As an example, both commands are equivalent:
%
%    \begin{latexcode}
%        \usepackage[itemizer, keep-description]{palettize}
%    \end{latexcode}
%
%    \vspace{-\baselineskip}
%    \begin{latexcode}
%        \usepackage[keep-description]{palettize-itemizer}
%    \end{latexcode}
%\end{macro*}
%


\section{The palettes of \PackageName{palettize}}\label{sec:palettes}

The \PackageName{palettize} package sees palettes as lists of background colors. Each color can be a single background color like those defined using \PackageName{xcolor} or a foreground/background pair. A color pair is written \Argument{fg~color}~\latexinline{on}~\Argument{bg~color}, such as \latexinline{white on blue}. When only a single color is used in a palette, the foreground color is the current color of the document. For example, \latexinline{green} means \latexinline{. on green}\footnote{The ``dot'' color (\latexinline{.}) is the current color in the \PackageName{xcolor} package.}

A palette is created with \MacroRef{PLTCreatePalette} and since several different palettes can be created, the concept of the \textit{current} palette is used. To change the current palette, \MacroRef{PLTUsePalette} should be used. There is a default predefined palette (see~\Cref{sec:available-palettes}).

Most macros will use the current palette unless otherwise noted.

\begin{macro}{PLTCreatePalette}[\MArg{palette~name}]
    \Macro{PLTCreatePalette} creates a new, empty palette named \Argument{palette~name} and inserts its name into the list of defined palettes. Attempting to create a palette with an existing name results in an error.
\end{macro}

\begin{macro}{PLTSetPalette}[\OArg{palette~name}\MArg{list~of~colors}]
    The \Argument{list~of~colors} is a comma-separated list of colors (single or paired) to be assigned to the palette \Argument{palette~name}.
\end{macro}

\begin{tcolorbox}
    color
\end{tcolorbox}

\begin{example}{listing only, breakable = false}
    \PLTCreatePalette{sample}
    \PLTSetPalette{sample}{
        white on blue,
        white on red!50!black,
        blue on orange!60,
        green  % single color
    }
\end{example}

To set the current palette, \MacroRef{PLTUsePalette} must be used.

\begin{macro}{PLTUsePalette}[\MArg{palette~name}]
    This macro makes \Argument{palette~name} the current palette, thus defining which palette macros, like \MacroRef{PLTUseCurrentColor} and \MacroRef{PLTNextColor} for example, will work with.
\end{macro}

A palette set with \MacroRef{PLTSetPalette} is an ordered list of color and after set, its first color is the current color of the palette. The \PackageName{xcolor}'s colors \latexinline{PLTBGColor} and \latexinline{PLTFGColor} hold the current color.

\begin{example}{}
    \PLTCreatePalette{my colors}
    \PLTSetPalette{my colors}{
        yellow on blue,
        white on black,
        black!40
    }
    \PLTUsePalette{my colors}

    The first color is \colorbox{PLTBGColor}{\textcolor{PLTFGColor}{this one}} and the second is \PLTNextColor\colorbox{PLTBGColor}{\textcolor{PLTFGColor}{this}}.

    \PLTNextColor
    And \colorbox{PLTBGColor}{\textcolor{PLTFGColor}{this}} is the last one.
\end{example}


To change the current color, \MacroRef{PLTNextColor} will advance to the next color and \MacroRef{PLTResetLoop} will set the current color back to the first.

\begin{macro}{PLTNextColor}[\OArg{palette~name}]
    \Macro{PLTNextColor} changes the current color to the next one in the sequence cyclically.

    If an optional \Argument{palette~name} is specified, then the current color of this pattern will be modified. This will not change the current palette.
\end{macro}

\begin{macro}{PLTResetLoop}[\OArg{palette~name}]
    Sets the first color in the palette as the current color.

    If an optional \Argument{palette~name} is specified, then the current color of this pattern will be modified. This will not change the current palette.
\end{macro}

\begin{example}{}
    % \usepackage{etoolbox}
    \PLTCreatePalette{primary}
    \PLTSetPalette{primary}{red, blue, yellow}
    \PLTCreatePalette{secondary}
    \PLTSetPalette{secondary}{green, orange, violet}

    \PLTUsePalette{primary}  % sets current palette

    \forcsvlist{
        \PLTUseCurrentColor
        \fcolorbox{black}{PLTBGColor}{\hspace{3em}} \qquad
        \PLTUseCurrentColor[secondary]
        \fcolorbox{black}{PLTBGColor}{\hspace{3em}}
        \PLTNextColor
        \PLTNextColor[secondary]
    }{\par, \par, \par, \par, \par, \par, \par} % 7 times
\end{example}


As already described, the current color always sets \latexinline{PLTBGColor} and \latexinline{PLTFGColor}. Their names are available through \MacroRef{PLTBGColorName} and \MacroRef{PLTFGColorName} respectively.

\begin{macro}{PTLBGColorName}[\OArg{pattern~name}]
    \Macro{PTLBGColorName} expands to the current background color name of the current pattern.

    If an optional \Argument{palette~name} is specified, then the current color of this pattern will be modified. This will not change the current palette.
\end{macro}

\begin{macro}{PTLFGColorName}[\OArg{pattern~name}]
    \Macro{PTLFGColorName} expands to the current foreground color name of the current pattern.

    If an optional \Argument{palette~name} is specified, then the current color of this pattern will be modified. This will not change the current palette.
\end{macro}

\begin{example}{}
    % \usepackage{etoolbox}
    \definecolor{indigo}{RGB}{75, 0, 130}
    \PLTCreatePalette{rainbow}
    \PLTSetPalette{rainbow}{red, orange, yellow, green, blue, indigo, violet}
    \PLTUsePalette{rainbow}

    \begin{center}
        \forcsvlist{%
            \textcolor{PLTBGColor}{\textbf{\PLTBGColorName}}, %
            \PLTNextColor%
        }{{}, {}, {}, {}, {}, {}}%
        and \textcolor{PLTBGColor}{\textbf{\PLTBGColorName}}.

        \medskip
        \PLTResetLoop
        \forcsvlist{%
            \textcolor{PLTBGColor}{\rule{1.15cm}{1em}}%
            \PLTNextColor%
        }{{}, {}, {}, {}, {}, {}, {}}%
    \end{center}
\end{example}

\subsection{Available palettes}\label{sec:available-palettes}

Some palettes are shipped with this package and can be loaded with \MacroRef{PLTUseResource}.

\begin{macro}{PLTUseResource}[\MArg{list~of~resources}]
    The \Argument{list~of~resources} is a comma-separated list of resources that can be loaded. This macro can allow the use of pre-existing palettes, which are stored in files called \texttt{palettize-\Argument{resource~name}.tex}.

    Palettes should be kept in this type of file, allowing new palettes to be created and made available for use.
\end{macro}

\begin{latexcode}
    \PLTUseResource{sliced-citrus, toasted-peach}
\end{latexcode}

\subsubsection*{The default palette}

A palette called \latexinline{nightfall-ambiance} is always loaded and it is used as the default palette by all modules.

\begin{tcolorbox}[width = 0.5\textwidth, colback = white, colframe = gray, boxrule = 0.1pt]
    \textbf{Palette nightfall-ambiance}\medskip\par
    \PLTIteratePalette{nightfall-ambiance}{%
        \tikz \node[draw, fill = PLTBGColor, text = PLTFGColor, font = \bfseries\sffamily, text width = 0.95\linewidth, text height = 0.8em] {\PLTFGColorName\ on \PLTBGColorName };
    }\par
\end{tcolorbox}%


\subsubsection*{List of palettes}

The following palettes are available.

\begin{tcbraster}[raster columns = 2]
    \PLTIteratePaletteList{
        \expandafter\ifstrequal\expandafter{\PLTCurrentPalette}{nightfall-ambiance}{}{%
            \begin{tcolorbox}[colback = white, colframe = gray, boxrule = 0.1pt]
                \small%
                \textbf{Palette \PLTCurrentPalette}\medskip\par
                \latexinline{\PLTUseResource}\texttt{\{\PLTCurrentPalette\}}\strut\bigskip\par
                \PLTIteratePalette{\PLTCurrentPalette}{%
                    \PLTUsePalette{\PLTCurrentPalette}
                    \tikz \node[draw, fill = PLTBGColor, text = PLTFGColor,
                        font = \bfseries\sffamily, text width = 0.95\linewidth, text height = 0.8em] {\PLTFGColorName\ on \PLTBGColorName\strut};%
                    \par%
                }
            \end{tcolorbox}%
        }%
    }
\end{tcbraster}

\subsection{Palettes are local!}\label{sec:palettes-are-local}

For now, any of the macros that manipulate palettes use global changes. This means that a palette created inside a group (\Macro{begingroup}/\Macro{endgroup}), for example, will only exist inside that group. There are major drawbacks to this approach, as any changes to macros that create local scopes will break the expected behavior.

This may change in future versions.

\subsection{Iterating over palettes and colors}

A simple mechanism is provided to access the list of palettes and the colors inside each one.

\begin{macro}{PLTIteratePaletteList}[\MArg{code}]
    This macro executes \Argument{code} for each existing palette. In each iteration \MacroDef{PLTCurrentPalette} is set to the palette's name, but the palette is not set as default with \MacroRef{PLTUsePalette}.
\end{macro}

\begin{example}{}
    Palletes:

    \begin{enumerateenumerate}
        \PLTIteratePaletteList{\item \PLTCurrentPalette}
    \end{enumerateenumerate}
\end{example}

\begin{macro}{PLTIteratePalette}[\MArg{palette name}\MArg{code}]
    This provides an iteration through all colors in \Argument{palette name} executing \Argument{code}. The colors \latexinline{PLTBGColor} and \latexinline{PLTFGColor} are set properly in each interaction. \MacroRef{PLTBGColorName} and \Macro{PLTFGColorName} are also available.
\end{macro}

\begin{example}{unbreakable}
    % \usepackage{tikz}
    \PLTCreatePalette{new example}
    \PLTSetPalette{new example}{
        red!50!black on orange!50,
        green!50!black on green!40!black!50,
        blue!60 on blue!50!black
    }
    \PLTIteratePalette{new example}{%
        \tikz\path[draw = PLTFGColor, fill = PLTBGColor, ultra thick] (0, 0) circle (5pt);\quad%
    }
\end{example}


\section{Modules}

This sections describes the modules in detail.

\subsection{Boxes}\label{sec:boxes}

Boxes are just the \textit{raster array} from \PackageName{tcolorbox} with support for palettes. Therefore, practically all features from the \latexinline{tcbraster} environment can be used. The same is true for each color box.

The intent here is to provide an easier way to get things done.

The \PackageName{palettize-boxes} provides a single option: \OptionRef{handwriting}.

\begin{option}{handwriting}{}
    The option \Option{hanwriting} loads Emerald fonts.

    font JD\footnotemark.

    is specified, as seen in \Cref{sec:box-styles}.

    Handwritten boxes requires
\end{option}
\footnotetext{\url{https://ctan.org/pkg/emerald}; \url{https://tug.org/FontCatalogue/jd/}.}

The environment \latexinline{PLTBoxRaster} is used to create a box for each item in a list. The current palette is used to choose the colors used in each box.

\begin{example}{}
    This is a boxed list with the current (default) palette:

    \begin{PLTBoxRaster}[enumerate]
        \item Software is related to the programs that instruct the execution of a computer.
        \item Hardware is the physical part of a computer, such as processor, memory, motherboard, data storage units etc.
        \item Firmware is the software that provides low-level control of computing device hardware.
        \item Middleware is a type of computer software program that provides services to software applications beyond those available from the operating system.
    \end{PLTBoxRaster}
\end{example}

%Each item in the list corresponds to a \Macro{item} and any text before the first item is ignored\footnote{The body of the environment is processed with \PackageName{palettize-getitem} (\Cref{sec:getitems}).}.
%
%An optional title for each box can be provided.
%
%\begin{example}{}
%    \begin{PLTBoxRaster}
%        \item[Software] Computer programs that instruct the execution of a computer.
%        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item[Firmware] Software that provides low-level control of computing device hardware.
%        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{PLTBoxRaster}
%\end{example}
%
%Since boxes are rendered using \PackageName{tcolorbox}'s raster, the new environments can pass specific options using angle brackets.
%
%\begin{example}{}
%    \begin{PLTBoxRaster}
%        <raster equal height = none, raster valign = center, raster columns = 4>
%        \item[Software] Computer programs that instruct the execution of a computer.
%        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item[Firmware] Software that provides low-level control of computing device hardware.
%        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{PLTBoxRaster}
%\end{example}
%
%Numbered boxes are created using the option \OptionInd{enumerate}.
%
%\begin{example}{}
%    \begin{PLTBoxRaster}[enumerate]
%        \item[Software] Computer programs that instruct the execution of a computer.
%        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item[Firmware] Software that provides low-level control of computing device hardware.
%        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{PLTBoxRaster}
%\end{example}
%
%The numbering style can be set with \OptionInd{arabic} for regular arabic numbers (default), \OptionInd{alph} for lowercase letter, \OptionInd{Alph} for uppercase letter, \OptionInd{roman} for lower case roman numbers, \OptionInd{Roman} for roman upper case, or \OptionInd{fnsymbol} for footnote-like symbols.
%
%\begin{example}{}
%    \begin{PLTBoxRaster}[enumerate, Roman]
%        \item[Software] Computer programs that instruct the execution of a computer.
%        \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item[Firmware] Software that provides low-level control of computing device hardware.
%        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{PLTBoxRaster}
%\end{example}
%
%The boxes colors depend on the current palette.
%
%\begin{example}{}
%    \PLTUseResource{toasted-peach}
%    \PLTUsePalette{toasted-peach}
%    \begin{tcolorbox}[colback = black]
%        \begin{PLTBoxRaster}[enumerate, fnsymbol]
%            \item[Software] Computer programs that instruct the execution of a computer.
%            \item[Hardware]The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%            \item[Firmware] Software that provides low-level control of computing device hardware.
%            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%        \end{PLTBoxRaster}
%    \end{tcolorbox}
%\end{example}
%
%\subsubsection*{Box styles}
%
%By default, boxes use a preset style called \OptionInd{itemize}, which can be specified as an optional argument to \latexinline{PLTBoxRaster} environments. As seen in previous examples, \OptionInd{enumerate} provides a box style with numbering.
%
%\begin{example}{}
%    \begin{tcbraster}
%        \begin{tcolorbox}
%            \begin{PLTBoxRaster}[
%                itemize,
%                raster = {raster columns = 2}
%            ]
%                \item One
%                \item Two
%                \item Three
%                \item Four
%            \end{PLTBoxRaster}
%        \end{tcolorbox}
%        \begin{tcolorbox}
%            \begin{PLTBoxRaster}[
%                enumerate, Roman,
%                raster = {raster columns = 2}
%            ]
%                \item One
%                \item Two
%                \item Three
%                \item Four
%            \end{PLTBoxRaster}
%        \end{tcolorbox}
%    \end{tcbraster}
%\end{example}
%
%\subsubsection*{Using \PackageName{tcolorbox}'s resources}
%
%Options to the \latexinline{tcbraster} environment can be added with option \OptionInd{raster}.
%
%\begin{example}{}
%    \PLTUseResource{toasted-peach}
%    \PLTUsePalette{toasted-peach}
%    \begin{tcolorbox}[colback = black]
%        \begin{PLTBoxRaster}[raster = {raster equal height = none, raster valign = top, raster columns = 4}]
%            \item[Software] Computer programs that instruct the execution of a computer.
%            \item[Hardware]The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%            \item[Firmware] Software that provides low-level control of computing device hardware.
%            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%        \end{PLTBoxRaster}
%    \end{tcolorbox}
%\end{example}
%
%When using \OptionInd{raster set} all \PackageName{palettize-boxes}' default options are replaced, allowing full control.
%
%\begin{example}{}
%    \PLTUseResource{sting-has-sprung}
%    \PLTUsePalette{sting-has-sprung}
%    \begin{PLTBoxRaster}[raster set = {}]  % ignore palettize-boxes' presets
%        \item[Software] Computer programs that instruct the execution of a computer.
%        \item[Hardware]The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item[Firmware] Software that provides low-level control of computing device hardware.
%        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{PLTBoxRaster}
%\end{example}
%
%The options \OptionInd{box} and \OptionInd{box set} work in the same way for all boxes.
%
%\begin{example}{}
%    \begin{PLTBoxRaster}[box = {boxrule = 0pt, halign = center, sharp corners}]
%        \item[Software] Computer programs that instruct the execution of a computer.
%        \item[Hardware]The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item[Firmware] Software that provides low-level control of computing device hardware.
%        \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{PLTBoxRaster}
%\end{example}
%
%New styles can be defined.
%
%\begin{example}{}
%    \tcbset{
%        my item/.style = {
%            colframe = PLTBGColor,
%            enhanced,
%            interior style={
%                left color = PLTBGColor!80,
%                right color = PLTBGColor!60,
%            },
%            valign = center,
%            fontupper = \sffamily\color{PLTFGColor}\scshape\large,
%            fonttitle = \ttfamily\color{PLTFGColor!10},
%            title = {Item \#\PLTCounterStyle{tcbrasternum}},
%            rotate = 10,
%            lifted shadow = {1mm}{-2mm}{3mm}{0.1mm}{black!50!white},
%            sharp corners,
%            rounded corners = east,
%        },
%    }
%
%    \begin{PLTBoxRaster}[my item, raster = {raster width = 0.8\linewidth}]
%        \item One
%        \item Two
%        \item Three
%    \end{PLTBoxRaster}
%\end{example}
%
%
%\subsubsection{Available box styles}\label{sec:box-styles}
%
%\noindent\textbf{Handwriting}
%
%\begin{example}{}
%    My first list:\\
%    \begin{PLTBoxRaster}[handwriting, palette = toasted-peach]
%        \item One
%        \item Two
%        \item Three
%    \end{PLTBoxRaster}
%
%    \bigskip
%    My second list:\\
%    \begin{PLTBoxRaster}[handwriting, palette = sting-has-sprung]
%        \item [First] One
%        \item [Second] Two
%        \item [Third] Three
%    \end{PLTBoxRaster}
%\end{example}
%
%\noindent\textbf{Schedule}
%
%\begin{example}{}
%    \PLTUsePalette{toasted-peach}
%    \begin{PLTBoxRaster}[month schedule]
%        \item [April]
%        \begin{PLTBoxRaster}[day schedule]
%            \item [9] First meeting\\\&\\Welcome party
%            \item [21] Second meeting
%        \end{PLTBoxRaster}
%        \item [July]
%        \begin{PLTBoxRaster}[day schedule]
%            \item [3] Staff meeting
%            \item [27] Third meeting
%        \end{PLTBoxRaster}
%        \item [October]
%        \begin{PLTBoxRaster}[day schedule]
%            \item [8] Final meeting
%        \end{PLTBoxRaster}
%        \item [December]
%        \begin{PLTBoxRaster}[day schedule]
%            \item [11] Party
%            \item [25] Christmas
%        \end{PLTBoxRaster}
%    \end{PLTBoxRaster}
%\end{example}
%
%\subsection{Lists}\label{sec:itemizer}
%
%The module \PackageName{palettize-itemizer} adds color palettes to lists. Currently, the environments \latexinline{enumerate}, \latexinline{itemize}, and \latexinline{description} are affected. The default palette is applied to these environments (see \Cref{sec:available-palettes}).
%
%\begin{macro*}{usepackage}{\OArg{options list}}[palettize-itemizer]
%    Package options include the following:
%
%    \begin{option}{keep-enumerate}{}
%        When specified, \Option{keep-enumerate} preserves the original \latexinline{enumerate} environment untouched.
%    \end{option}
%
%    \begin{option}{keep-itemize}{}
%        When specified, \Option{keep-itemize} preserves the original \latexinline{itemize} environment untouched.
%    \end{option}
%
%    \begin{option}{keep-description}{}
%        When specified, \Option{keep-description} preserves the original \latexinline{description} environment untouched.
%    \end{option}
%
%    \begin{option}{keep-all}{}
%        This is the same as using \Option{keep-enumerate}, \Option{keep-itemize}, and \Option{keep-description} toghether.
%    \end{option}
%
%    All of these options can be specified also when using \latexinline{\usepackage{palettize}}.
%\end{macro*}
%
%The modified lists are exemplified below.
%
%\begin{example}{}
%    \begin{itemize}
%        \item Software: Computer programs that instruct the execution of a computer.
%        \item Hardware: The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item Firmware: Software that provides low-level control of computing device hardware.
%        \item Middleware: Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{itemize}
%\end{example}
%
%\begin{example}{}
%    \begin{enumerate}
%        \item Software: Computer programs that instruct the execution of a computer.
%        \item Hardware: The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item Firmware: Software that provides low-level control of computing device hardware.
%        \item Middleware: Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{enumerate}
%\end{example}
%
%\begin{example}{}
%    \begin{tabular}{p{0.45\linewidth}p{0.45\linewidth}}
%        \begin{description}
%            \item[Software] Computer programs that instruct the execution of a computer.
%            \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%            \item[Firmware] Software that provides low-level control of computing device hardware.
%            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%        \end{description}
%        &
%        \PLTUseResource{sliced-citrus}
%        \PLTUsePalette{sliced-citrus}
%        \begin{description}
%            \item[Software] Computer programs that instruct the execution of a computer.
%            \item[Hardware] The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%            \item[Firmware] Software that provides low-level control of computing device hardware.
%            \item[Middleware] Type of computer software program that provides services to software applications beyond those available from the operating system.
%        \end{description}
%    \end{tabular}
%\end{example}
%
%\subsubsection{New environments for lists}
%
%Three new environments were created to handle palette-aware lists: \latexinline{PLTEnumerate}, \latexinline{PLTItemize}, and \latexinline{PLTDescription}. These are used to replace their respective counterparts. Yet, they can be used directly.
%
%\begin{center}
%    \begin{tabular}{ll}
%        \textbf{Environment}      & \textbf{Replacement environment} \\
%        \hline
%        \latexinline{enumerate}   & \latexinline{PLTEnumerate}       \\
%        \latexinline{itemize}     & \latexinline{PLTItemize}         \\
%        \latexinline{description} & \latexinline{PLTDescription}     \\
%        \hline
%    \end{tabular}
%\end{center}
%
%When the option \OptionRef{keep-all} is used, all colored environments are available using these alternatives.
%
%\begin{example}{}
%    \begin{PLTEnumerate}
%        \item One
%        \item Two
%        \item Three
%    \end{PLTEnumerate}
%
%    \medskip
%    \begin{PLTItemize}
%        \item One
%        \item Two
%        \item Three
%    \end{PLTItemize}
%
%    \medskip
%    \begin{PLTDescription}
%        \item [One] First.
%        \item [Two] Second.
%        \item [Three] Third.
%    \end{PLTDescription}
%\end{example}
%
%\subsubsection{Accessing the original list environments}
%
%If a list environment was not preserved by any of the \Option{keep-\Argument{list name}} options it can still be used with the renamed environments below.
%
%\begin{center}
%    \begin{tabular}{ll}
%        \textbf{Environment}      & \textbf{Renamed environment}         \\
%        \hline
%        \latexinline{enumerate}   & \latexinline{enumerateenumerate}     \\
%        \latexinline{itemize}     & \latexinline{itemizeitemize}         \\
%        \latexinline{description} & \latexinline{descriptiondescription} \\
%        \hline
%    \end{tabular}
%\end{center}
%
%\bigskip
%\begin{example}{}
%    This is an original unnumbered list:
%
%    \begin{itemizeitemize}
%        \item Software: Computer programs that instruct the execution of a computer.
%        \item Hardware: The physical parts of a computer, such processor, memory, motherboard, data storage units etc.
%        \item Firmware: Software that provides low-level control of computing device hardware.
%        \item Middleware: Type of computer software program that provides services to software applications beyond those available from the operating system.
%    \end{itemizeitemize}
%\end{example}
%
%Double-named versions are always created, even if \Option{keep-\Argument{list~name}} is specified as an option.
%
%\subsection{Compatibility with other packages}
%
%The module \PackageName{palettize-itemizer} appears to be compatible with \PackageName{enumitem}\footnote{\url{https://www.ctan.org/pkg/enumitem}} and \PackageName{enumerate}\footnote{\url{https://www.ctan.org/pkg/enumerate}}, but no extensive testing has been performed.
%


\section{Beamer}

So far, everything seems to work fine with Beamer, as long as the slide overlays remain simple.

Support for using this package with the Beamer class is in its early stages and is a long-term effort.

%\section{Known issues and limitations}\label{sec:known-issues-and-limitations}
%
%\begin{center}
%    \begin{descriptiondescription}
%        \item[\PackageName{pgffor}] current color is local and \latexinline{\foreach} will not work.
%        \item[] Foreground color changes inside boxes using \Macro{color} or \Macro{textcolor} are bounded by the limitations described in the documentation of \PackageName{xcolor} (Section~2.6.4, \PackageName{xcolor} v2.14, 2022/06/12).
%    \end{descriptiondescription}
%\end{center}


\section{Wish list}

Future work should deal with:
\begin{itemizeitemize}
    \item Adding global options that change the default behavior;
    \item Adding local options to the new environments, so global behavior may be changed locally;
    \item Thinking about local vs. global actions on palettes (see \Cref{sec:palettes-are-local}).
\end{itemizeitemize}

\clearpage
\appendix


\section{Processing itemized lists}\label{sec:getitems}
These are tools for processing lists with \Macro{item} as itemizer.

\begin{macro}{PLTGatherItems}[\MArg{text}]
    The \Argument{text} is parsed looking for \Macro{item} macros and each item is stored in an internal list. Anything before the first \Macro{item} is also stored as the header of the list. The header can be retrieved with \MacroRef{PLTGetHeader} and items individually retrieved with \MacroRef{PLTGetItem}. The items list can also be sequentially processed using \MacroRef{PLTMapCommand}.

    Leading and following spaces are trimmed.
\end{macro}

\begin{macro}{PLTGetHeader}
    This macro expands to the header of the last list parsed with \MacroRef{PLTGatherItems}.
\end{macro}

\begin{macro}{PLTGetItem}[\MArg{item~number}]
    This macro expands to the \Argument{item~number}\textsuperscript{th} item the last list parsed with \MacroRef{PLTGatherItems}.
\end{macro}

\begin{example}{}
    \PLTGatherItems{
        Grocery list
        \item Beans
        \item Broccoli
        \item Cabbage
        \item Cauliflower
        \item Ginger
        \item Ladyfinger
    }

    This is my \PLTGetHeader: \PLTGetItem{1} and \PLTGetItem{4} are present.
\end{example}

\begin{macro}{PLTMapCommand}[\MArg{macro}]
    \Macro{PLTMapCommand} sequentially runs \Argument{macro} in every item.
\end{macro}

\begin{example}{}
    \PLTGatherItems{
        \item artificial intelligence,
        \item cloud computing, and
        \item security.
    }
    \NewDocumentCommand{\showwithbullet}{ +m }{\textbullet~#1 }
    Important topics: \PLTMapCommand{\showwithbullet}
\end{example}

%! formatter = off
\begin{example}{}
    \NewDocumentCommand{\showinline}{ +m }{>>~#1 }
    \NewDocumentEnvironment{importantlisting}{ +b }{%
        \PLTGatherItems{#1}
        \textbf{\PLTGetHeader}
        \PLTMapCommand{\showinline}
        }{}

    \begin{importantlisting}
        Very important things:\par
        \item Eat%
        \begin{importantlisting}
            How?
            \item Healthy
            \item Many vegetables
            \item No TV
            \item No smartphone
        \end{importantlisting}
        \par
        \item Pray\par
        \item Love\par
    \end{importantlisting}
\end{example}
%! formatter = on

\begin{macro}{PLTParseItem}[\MArg{type~macro}\MArg{angle~macro}\MArg{brackets-macro}\MArg{text~macro}\MArg{text}]
    This macro parses \Argument{text} looking for leading options using both angle or square brackets. The results are:
    \begin{itemizeitemize}
        \item \Argument{type~macro} is set to
        \begin{itemizeitemize}
            \item \latexinline{A} if only angle brackets are present;
            \item \latexinline{B} if only (square) brackets are present;
            \item \latexinline{AB} if both angle and square brackets are present, in any order;
            \item \latexinline{N} otherwise;
        \end{itemizeitemize}
        \item \Argument{angle~macro} is set to the content between angle brackets;
        \item \Argument{brackets~macro} is set to the content between brackets;
        \item \Argument{text~macro} is set to the remaining content.
    \end{itemizeitemize}
\end{macro}

\begin{example}{}
    \PLTParseItem{\opttype}{\angleopts}{\bracketopts}{\body}{%
        [font=sffamily]<*>Some \textit{text}%
    }
    \noindent Code: \texttt{\opttype}\par
    In angle brackets: \texttt{\angleopts}\par
    In brackets: \texttt{\bracketopts}\par
    Text: \texttt{\body}\par
\end{example}

%! formatter = off
\begin{example}{}
    \NewDocumentCommand{\showiteminbox}{ +m }{%
        \PLTParseItem{\opttype}{\angleopts}{\bracketopts}{\body}{#1}%
        \fbox{%
            \strut%
            \PLTIfType{\opttype}{A, AB}{% if <> present, change font
                \angleopts%  new font
            }{%
                \sffamily%  default font for list
            }%
            \PLTIfType{\opttype}{B, AB}{% if [] present, change color
                \color{\bracketopts}%  new color
            }{%
                \color{gray}%  default color
            }%
            \body%
        }%
    }
    \NewDocumentEnvironment{boxedlist}{ +b }{%
        \PLTGatherItems{#1}%
        \PLTMapCommand{\showiteminbox}
        }{}

    \begingroup
    \color{brown}
    List:
    \begin{boxedlist}
        \item[orange]<\ttfamily> Orange  % changes color and font
        \item<\ttfamily>[orange] Orange again % changes color and font
        \item[blue] Blue  % changes only color
        \item<> Magenta?  % suppresses font (use current document's font)
        \item[green!50!black] Green  % changes only color
        \item[.] Brown  % uses current document's color
    \end{boxedlist}
    \endgroup
\end{example}
%! formatter = on

%% Index
\printindex

\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%